---
permalink: admin/grid-federation-manage-tenants.html 
sidebar: sidebar 
keywords: grid federation, manage tenant, use grid federation permission, remove permission, cross grid replication 
summary: 您可以允许 S3 租户帐户在两个StorageGRID系统之间使用网格联合连接。当允许租户使用连接时，需要采取特殊步骤来编辑租户详细信息或永久删除租户使用该连接的权限。 
---
= 管理电网联合的允许租户
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以允许 S3 租户帐户在两个StorageGRID系统之间使用网格联合连接。当允许租户使用连接时，需要采取特殊步骤来编辑租户详细信息或永久删除租户使用该连接的权限。

.开始之前
* 您已使用link:../admin/web-browser-requirements.html["支持的网络浏览器"]。
* 你有link:admin-group-permissions.html["Root访问权限"]针对您登录的网格。
* 你有link:grid-federation-create-connection.html["创建了电网联合连接"]两个网格之间。
* 您已查看了link:grid-federation-what-is-account-clone.html["账户克隆"]和link:grid-federation-what-is-cross-grid-replication.html["跨网格复制"]。
* 根据要求，您已经为连接中的两个网格配置了单点登录 (SSO) 或识别联合。看link:grid-federation-what-is-account-clone.html["什么是账户克隆"] 。




== 创建允许的租户

如果您希望允许新的或现有的租户帐户使用网格联合连接进行帐户克隆和跨网格复制，请按照常规说明进行操作link:creating-tenant-account.html["创建新的 S3 租户"]或者link:editing-tenant-account.html["编辑租户帐户"]并注意以下几点：

* 您可以从连接中的任一网格创建租户。创建租户的网格是_租户的源网格_。
* 连接状态必须为*已连接*。
* 当创建或编辑租户以启用*使用网格联合连接*权限，然后保存在第一个网格上时，相同的租户会自动复制到另一个网格。租户被复制的网格是_租户的目标网格_。
* 两个网格上的租户将具有相同的 20 位帐户 ID、名称、描述、配额和权限。或者，您可以使用*描述*字段来帮助识别哪个是源租户，哪个是目标租户。例如，在网格 1 上创建的租户的描述也会出现在复制到网格 2 的租户中：“此租户是在网格 1 上创建的。”
* 出于安全原因，本地 root 用户的密码不会被复制到目标网格。
+

TIP: 在本地 root 用户登录到目标网格上的复制租户之前，该网格的网格管理员必须link:changing-password-for-tenant-local-root-user.html["更改本地 root 用户的密码"]。

* 当新的或编辑的租户在两个网格上都可用时，租户用户可以执行以下操作：
+
** 从租户的源网格创建组和本地用户，这些组和本地用户会自动克隆到租户的目标网格。看link:../tenant/grid-federation-account-clone.html["克隆租户组和用户"] 。
** 创建新的 S3 访问密钥，可以选择将其克隆到租户的目标网格。看link:../tenant/grid-federation-clone-keys-with-api.html["使用 API 克隆 S3 访问密钥"] 。
** 在连接中的两个网格上创建相同的存储桶，并启用单向或双向跨网格复制。看link:../tenant/grid-federation-manage-cross-grid-replication.html["管理跨网格复制"] 。






== 查看允许的租户

您可以查看允许使用电网联合连接的租户的详细信息。

.步骤
. 选择*租户*。
. 在租户页面中，选择租户名称以查看租户详细信息页面。
+
如果这是租户的源网格（即，如果租户是在此网格上创建的），则会出现一个横幅提醒您租户已克隆到另一个网格。如果您编辑或删除此租户，您的更改将不会同步到其他网格。

+
image::../media/grid-federation-tenant-detail.png[租户详细信息页面中的“网格联合”选项卡]

. （可选）选择“网格联合”选项卡link:../monitor/grid-federation-monitor-connections.html["监控电网联合连接"]。




== 编辑允许的租户

如果您需要编辑具有“使用网格联合连接”权限的租户，请按照以下常规说明进行操作link:editing-tenant-account.html["编辑租户帐户"]并注意以下几点：

* 如果租户具有*使用网格联合连接*权限，您可以从连接中的任一网格编辑租户详细信息。但是，您所做的任何更改都不会复制到另一个网格。如果您想要保持网格之间的租户详细信息同步，则必须在两个网格上进行相同的编辑。
* 编辑租户时，您无法清除*使用网格联合连接*权限。
* 编辑租户时，您无法选择不同的网格联合连接。




== 删除允许的租户

如果您需要删除具有“使用网格联合连接”权限的租户，请按照以下常规说明进行操作link:deleting-tenant-account.html["删除租户帐户"]并注意以下几点：

* 在删除源网格上的原始租户之前，您必须删除源网格上该帐户的所有存储桶。
* 在删除目标网格上的克隆租户之前，您必须删除目标网格上该帐户的所有存储桶。
* 如果您删除原始租户或克隆的租户，则该帐户将不再用于跨网格复制。
* 如果您要删除源网格上的原始租户，则克隆到目标网格的任何租户组、用户或密钥都不会受到影响。您可以删除克隆的租户，也可以允许其管理自己的组、用户、访问密钥和存储桶。
* 如果您正在删除目标网格上的克隆租户，则当向原始租户添加新组或用户时，将发生克隆错误。
+
为了避免这些错误，请在从此网格中删除租户之前删除该租户使用网格联合连接的权限。





== [[remove-grid-federation-connection-permission]]删除使用电网联合连接权限

要阻止租户使用电网联合连接，您必须删除*使用电网联合连接*权限。

image::../media/grid-federation-remove-permission.png[删除电网联合连接的步骤]

在删除租户使用电网联合连接的权限之前，请注意以下事项：

* 如果任何租户的存储桶启用了跨网格复制，则您无法删除*使用网格联合连接*权限。租户帐户必须首先禁用其所有存储桶的跨网格复制。
* 删除“使用网格联合连接”权限不会删除任何已在网格之间复制的项目。例如，当租户的权限被删除时，两个网格上存在的任何租户用户、组和对象都不会从任何一个网格中删除。如果要删除这些项目，则必须从两个网格中手动删除它们。
* 如果要使用相同的网格联合连接重新启用此权限，请先在目标网格上删除此租户；否则，重新启用此权限将导致错误。



NOTE: 重新启用*使用网格联合连接*权限会使本地网格成为源网格，并触发克隆到所选网格联合连接指定的远程网格。如果租户帐户已存在于远程网格上，则克隆将导致冲突错误。

.开始之前
* 您正在使用link:../admin/web-browser-requirements.html["支持的网络浏览器"]。
* 你有link:admin-group-permissions.html["Root访问权限"]对于两个网格。




=== 禁用租户存储桶的复制

第一步，禁用所有租户存储桶的跨网格复制。

.步骤
. 从任一网格开始，从主管理节点登录到网格管理器。
. 选择 *配置* > *系统* > *网格联合*。
. 选择连接名称以显示其详细信息。
. 在“*允许的租户*”选项卡上，确定租户是否正在使用该连接。
. 如果租户已列入名单，指示他们link:../tenant/grid-federation-manage-cross-grid-replication.html["禁用跨网格复制"]连接中两个网格上的所有存储桶。
+

TIP: 如果任何租户存储桶启用了跨网格复制，则您无法删除*使用网格联合连接*权限。租户必须禁用两个网格上的存储桶的跨网格复制。





=== 删除租户的权限

禁用租户存储桶的跨网格复制后，您可以删除租户使用网格联合连接的权限。

.步骤
. 从主管理节点Sign in到网格管理器。
. 从网格联合页面或租户页面中删除权限。
+
[role="tabbed-block"]
====
.电网联合页面
--
.. 选择 *配置* > *系统* > *网格联合*。
.. 选择连接名称以显示其详细信息页面。
.. 在“*允许的租户*”选项卡上，选择租户的单选按钮。
.. 选择*删除权限*。


--
.租户页面
--
.. 选择*租户*。
.. 选择租户名称以显示详细信息页面。
.. 在*网格联合*选项卡上，选择连接的单选按钮。
.. 选择*删除权限*。


--
====
. 查看确认对话框中的警告，然后选择*删除*。
+
** 如果可以删除权限，您将返回到详细信息页面并显示成功消息。该租户无法再使用电网联合连接。
** 如果一个或多个租户存储桶仍启用了跨网格复制，则会显示错误。
+
image::../media/grid-federation-remove-permission-error.png[如果租户为存储桶启用了 cgr，则会显示错误消息]

+
您可以执行以下任一操作：

+
*** （受到推崇的。）Sign in到租户管理器并禁用每个租户存储桶的复制。看link:../tenant/grid-federation-manage-cross-grid-replication.html["管理跨网格复制"] 。然后，重复这些步骤以删除*使用电网连接*权限。
*** 强制删除权限。请参阅下一部分。




. 转到另一个网格并重复这些步骤以删除另一个网格上同一租户的权限。




== [[force_remove_permission]]强制移除权限

如有必要，即使租户存储桶已启用跨网格复制，您也可以强制删除租户使用网格联合连接的权限。

在强制取消租户许可之前，请注意以下一般注意事项<<remove-grid-federation-connection-permission,删除权限>>以及以下额外考虑：

* 如果您强制删除*使用网格联合连接*权限，则任何等待复制到另一个网格（已摄取但尚未复制）的对象将继续被复制。为了防止这些正在处理的对象到达目标存储桶，您还必须删除租户在另一个网格上的权限。
* 删除“使用网格联合连接”权限后，任何被提取到源存储桶中的对象都不会被复制到目标存储桶。


.步骤
. 从主管理节点Sign in到网格管理器。
. 选择 *配置* > *系统* > *网格联合*。
. 选择连接名称以显示其详细信息页面。
. 在“*允许的租户*”选项卡上，选择租户的单选按钮。
. 选择*删除权限*。
. 查看确认对话框中的警告，然后选择*强制删除*。
+
出现成功消息。该租户无法再使用电网联合连接。

. 根据需要，转到另一个网格并重复这些步骤，强制删除另一个网格上同一租户帐户的权限。例如，您应该在另一个网格上重复这些步骤，以防止正在处理的对象到达目标存储桶。

