---
permalink: admin/managing-high-availability-groups.html 
sidebar: sidebar 
keywords: manage high availability group, ha groups, admin node, gateway node, active interface, backup interface, priority order 
summary: 高可用性（HA）组为 S3 客户端提供高可用性数据连接，并为网格管理器和租户管理器提供高可用性连接。 
---
= 什么是高可用性 (HA) 组？
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
高可用性 (HA) 组为 S3 客户端提供高可用性数据连接，并为网格管理器和租户管理器提供高可用性连接。

您可以将多个管理和网关节点的网络接口分组为高可用性 (HA) 组。如果 HA 组中的活动接口出现故障，则备用接口可以管理工作负载。

每个 HA 组提供对选定节点上的共享服务的访问。

* 包含网关节点、管理节点或两者的 HA 组为 S3 客户端提供高可用性数据连接。
* 仅包含管理节点的 HA 组为网格管理器和租户管理器提供高可用性连接。
* 仅包含服务设备和基于 VMware 的软件节点的 HA 组可以为link:../admin/manage-s3-select-for-tenant-accounts.html["使用 S3 Select 的 S3 租户"]。使用 S3 Select 时建议使用 HA 组，但这不是必需的。




== 如何创建 HA 组？

. 您为一个或多个管理节点或网关节点选择一个网络接口。您可以使用网格网络（eth0）接口、客户端网络（eth2）接口、VLAN 接口或已添加到节点的访问接口。
+

NOTE: 如果接口具有 DHCP 分配的 IP 地址，则无法将其添加到 HA 组。

. 您指定一个接口作为主接口。除非发生故障，否则主接口是活动接口。
. 您可以确定任何备份接口的优先级顺序。
. 您为该组分配 1 到 10 个虚拟 IP (VIP) 地址。客户端应用程序可以使用这些 VIP 地址中的任何一个连接到StorageGRID。


有关说明，请参阅link:configure-high-availability-group.html["配置高可用性组"]。



== 活动接口是什么？

在正常运行期间，HA 组的所有 VIP 地址都添加到主接口，即优先级顺序中的第一个接口。只要主接口保持可用，当客户端连接到该组的任何 VIP 地址时就会使用它。也就是说，在正常运行期间，主接口是该组的“活动”接口。

同样，在正常运行期间，HA 组的任何较低优先级接口都充当“备份”接口。除非主（当前活动）接口不可用，否则不会使用这些备份接口。



== 查看节点当前HA组状态

要查看某个节点是否已分配给 HA 组并确定其当前状态，请选择 *NODES* > *_node_*。

如果“*概览*”选项卡包含“*HA 组*”条目，则该节点将分配给列出的 HA 组。组名后面的值是该节点在HA组中的当前状态：

* *活动*：HA 组当前托管在此节点上。
* *备份*：HA 组当前未使用此节点；这是一个备份接口。
* *已停止*：由于高可用性（keepalived）服务已被手动停止，因此 HA 组无法托管在此节点上。
* *故障*：由于以下一个或多个原因，HA 组无法托管在此节点上：
+
** 负载均衡器（nginx-gw）服务未在节点上运行。
** 节点的 eth0 或 VIP 接口已关闭。
** 此节点已关闭。




在此示例中，主管理节点已添加到两个 HA 组。该节点当前是管理员客户端组的活动接口和FabricPool客户端组的备份接口。

image::../media/ha_group_primary_interface.png[HA 组主接口]



== 当活动接口发生故障时会发生什么？

当前托管 VIP 地址的接口是活动接口。如果 HA 组包含多个接口并且活动接口出现故障，则 VIP 地址将按优先级顺序移动到第一个可用的备用接口。如果该接口出现故障，VIP 地址将移动到下一个可用的备份接口，依此类推。

以下任一原因都可能触发故障转移：

* 配置该接口的节点发生故障。
* 配置该接口的节点与所有其他节点失去连接至少 2 分钟。
* 活动接口处于 Down 状态。
* 负载均衡器服务停止。
* 高可用性服务停止。



NOTE: 活动接口所在节点外部的网络故障可能不会触发故障转移。同样，故障转移不是由网格管理器或租户管理器的服务触发的。

故障转移过程通常只需要几秒钟，并且速度足够快，客户端应用程序几乎不会受到任何影响，并且可以依靠正常的重试行为继续运行。

当故障解决并且更高优先级的接口再次可用时，VIP 地址将自动移动到可用的最高优先级接口。
