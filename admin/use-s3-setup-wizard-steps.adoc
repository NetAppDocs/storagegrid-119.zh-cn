---
permalink: admin/use-s3-setup-wizard-steps.html 
sidebar: sidebar 
keywords: FabricPool and S3 setup wizard, object storage system, S3 application 
summary: 您可以使用 S3 设置向导将StorageGRID配置为 S3 应用程序的对象存储系统。 
---
= 访问并完成 S3 设置向导
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以使用 S3 设置向导配置StorageGRID以用于 S3 应用程序。安装向导提供了应用程序访问StorageGRID存储桶和保存对象所需的值。

.开始之前
* 你有link:admin-group-permissions.html["Root访问权限"]。
* 您已审阅link:use-s3-setup-wizard.html["注意事项和要求"]使用向导。




== 访问向导

.步骤
. Sign inlink:web-browser-requirements.html["支持的网络浏览器"]。
. 如果仪表板上出现 * FabricPool和 S3 设置向导* 横幅，请选择横幅中的链接。如果横幅不再出现，请从网格管理器的标题栏中选择帮助图标，然后选择* FabricPool和 S3 设置向导*。
+
image::../media/help_menu.png[帮助菜单]

. 在FabricPool和 S3 设置向导页面的 S3 应用程序部分中，选择 *立即配置*。




== 步骤 1（共 6 步）：配置 HA 组

HA 组是每个包含StorageGRID负载均衡器服务的节点集合。  HA 组可以包含网关节点、管理节点或两者。

您可以使用 HA 组来帮助保持 S3 数据连接可用。如果 HA 组中的活动接口出现故障，则备份接口可以管理工作负载，而对 S3 操作的影响很小。

有关此任务的详细信息，请参阅link:managing-high-availability-groups.html["管理高可用性组"]。

.步骤
. 如果您计划使用外部负载均衡器，则无需创建 HA 组。选择“跳过此步骤”并前往<<第 2 步（共 6 步）：配置负载均衡器端点>>。
. 要使用StorageGRID负载均衡器，您可以创建一个新的 HA 组或使用现有的 HA 组。
+
[role="tabbed-block"]
====
.创建 HA 组
--
.. 要创建新的 HA 组，请选择*创建 HA 组*。
.. 对于*输入详细信息*步骤，请填写以下字段。
+
[cols="1a,2a"]
|===
| 字段 | 描述 


 a| 
HA组名称
 a| 
此 HA 组的唯一显示名称。



 a| 
描述（可选）
 a| 
该 HA 组的描述。

|===
.. 对于*添加接口*步骤，选择您想要在此 HA 组中使用的节点接口。
+
使用列标题对行进行排序，或输入搜索词以更快地找到接口。

+
您可以选择一个或多个节点，但每个节点只能选择一个接口。

.. 对于*优先考虑接口*步骤，确定此 HA 组的主接口和任何备份接口。
+
拖动行来更改“优先级顺序”列中的值。

+
列表中的第一个接口是主接口。除非发生故障，否则主接口是活动接口。

+
如果 HA 组包含多个接口并且活动接口出现故障，则虚拟 IP (VIP) 地址将按优先级顺序移动到第一个备份接口。如果该接口出现故障，VIP 地址将移动到下一个备份接口，依此类推。当故障解决后，VIP 地址将移回可用的最高优先级接口。

.. 对于*输入 IP 地址*步骤，请填写以下字段。
+
[cols="1a,2a"]
|===
| 字段 | 描述 


 a| 
子网 CIDR
 a| 
CIDR 表示法中的 VIP 子网地址——IPv4 地址后跟斜杠和子网长度（0-32）。

网络地址不得设置任何主机位。例如，  `192.16.0.0/22` 。



 a| 
网关 IP 地址（可选）
 a| 
如果用于访问StorageGRID 的S3 IP 地址与StorageGRID VIP 地址不在同一子网中，请输入StorageGRID VIP 本地网关 IP 地址。本地网关IP地址必须在VIP子网内。



 a| 
虚拟 IP 地址
 a| 
为 HA 组中的活动接口输入至少一个、最多十个 VIP 地址。所有 VIP 地址都必须位于 VIP 子网内。

至少一个地址必须是 IPv4。您也可以选择指定其他 IPv4 和 IPv6 地址。

|===
.. 选择*创建 HA 组*，然后选择*完成*返回 S3 设置向导。
.. 选择“*继续*”进入负载均衡器步骤。


--
.使用现有的 HA 组
--
.. 要使用现有的 HA 组，请从 *选择 HA 组* 中选择 HA 组名称。
.. 选择“*继续*”进入负载均衡器步骤。


--
====




== 第 2 步（共 6 步）：配置负载均衡器端点

StorageGRID使用负载平衡器来管理来自客户端应用程序的工作负载。负载平衡可最大限度地提高多个存储节点的速度和连接容量。

您可以使用所有网关和管理节点上存在的StorageGRID负载均衡器服务，也可以连接到外部（第三方）负载均衡器。建议使用StorageGRID负载均衡器。

有关此任务的详细信息，请参阅link:managing-load-balancing.html["负载平衡的注意事项"]。

要使用StorageGRID负载均衡器服务，请选择 * StorageGRID负载均衡器* 选项卡，然后创建或选择要使用的负载均衡器端点。要使用外部负载均衡器，请选择“*外部负载均衡器*”选项卡并提供有关已配置的系统的详细信息。

[role="tabbed-block"]
====
.创建端点
--
.步骤
. 要创建负载均衡器端点，请选择*创建端点*。
. 对于*输入端点详细信息*步骤，请填写以下字段。
+
[cols="1a,2a"]
|===
| 字段 | 描述 


 a| 
名称
 a| 
端点的描述性名称。



 a| 
端口
 a| 
您想要用于负载平衡的StorageGRID端口。对于您创建的第一个端点，此字段默认为 10433，但您可以输入任何未使用的外部端口。如果输入 80 或 443，则端点仅在网关节点上配置，因为这些端口在管理节点上保留。

*注意：*不允许使用其他网格服务使用的端口。查看link:../network/network-port-reference.html["网络端口参考"]。



 a| 
客户端类型
 a| 
必须是*S3*。



 a| 
网络协议
 a| 
选择 *HTTPS*。

*注意*：支持但不建议使用没有 TLS 加密的StorageGRID进行通信。

|===
. 对于*选择绑定模式*步骤，指定绑定模式。绑定模式控制如何使用任意 IP 地址或使用特定 IP 地址和网络接口访问端点。
+
[cols="1a,3a"]
|===
| 模式 | 描述 


 a| 
全局（默认）
 a| 
客户端可以使用任何网关节点或管理节点的 IP 地址、任何网络上任何 HA 组的虚拟 IP (VIP) 地址或相应的 FQDN 访问端点。

除非您需要限制此端点的可访问性，否则请使用*全局*设置（默认）。



 a| 
HA 组的虚拟 IP
 a| 
客户端必须使用 HA 组的虚拟 IP 地址（或相应的 FQDN）来访问此端点。

具有此绑定模式的端点都可以使用相同的端口号，只要您为端点选择的 HA 组不重叠。



 a| 
节点接口
 a| 
客户端必须使用选定节点接口的 IP 地址（或相应的 FQDN）来访问此端点。



 a| 
节点类型
 a| 
根据您选择的节点类型，客户端必须使用任何管理节点的 IP 地址（或相应的 FQDN）或任何网关节点的 IP 地址（或相应的 FQDN）来访问此端点。

|===
. 对于租户访问步骤，选择以下选项之一：
+
[cols="1a,2a"]
|===
| 字段 | 描述 


 a| 
允许所有租户（默认）
 a| 
所有租户帐户都可以使用此端点访问他们的存储桶。



 a| 
允许选定的租户
 a| 
只有选定的租户帐户可以使用此端点访问其存储桶。



 a| 
阻止选定的租户
 a| 
选定的租户帐户不能使用此端点访问其存储桶。所有其他租户都可以使用此端点。

|===
. 对于*附加证书*步骤，选择以下之一：
+
[cols="1a,2a"]
|===
| 字段 | 描述 


 a| 
上传证书（推荐）
 a| 
使用此选项上传 CA 签名的服务器证书、证书私钥和可选的 CA 包。



 a| 
生成证书
 a| 
使用此选项生成自签名证书。看link:configuring-load-balancer-endpoints.html["配置负载均衡器端点"]了解输入内容的详细信息。



 a| 
使用StorageGRID S3 证书
 a| 
仅当您已上传或生成StorageGRID全局证书的自定义版本时才使用此选项。看link:configuring-custom-server-certificate-for-storage-node.html["配置 S3 API 证书"]了解详情。

|===
. 选择“*完成*”返回 S3 安装向导。
. 选择“*继续*”进入租户和存储桶步骤。



NOTE: 对端点证书的更改最多可能需要 15 分钟才能应用到所有节点。

--
.使用现有的负载均衡器端点
--
.步骤
. 要使用现有端点，请从*选择负载均衡器端点*中选择其名称。
. 选择“*继续*”进入租户和存储桶步骤。


--
.使用外部负载均衡器
--
.步骤
. 要使用外部负载均衡器，请填写以下字段。
+
[cols="1a,2a"]
|===
| 字段 | 描述 


 a| 
FQDN
 a| 
外部负载均衡器的完全限定域名 (FQDN)。



 a| 
端口
 a| 
S3 应用程序将用于连接外部负载均衡器的端口号。



 a| 
证书
 a| 
复制外部负载均衡器的服务器证书并将其粘贴到此字段中。

|===
. 选择“*继续*”进入租户和存储桶步骤。


--
====


== 步骤 3（共 6 步）：创建租户和存储桶

租户是可以使用 S3 应用程序在StorageGRID中存储和检索对象的实体。每个租户都有自己的用户、访问密钥、存储桶、对象和一组特定的功能。

bucket 是用于存储租户的对象和对象元数据的容器。尽管租户可能拥有多个存储桶，但向导可以帮助您以最快捷、最简单的方式创建租户和存储桶。如果您稍后需要添加存储桶或设置选项，则可以使用租户管理器。

有关此任务的详细信息，请参阅link:creating-tenant-account.html["创建租户帐户"]和link:../tenant/creating-s3-bucket.html["创建 S3 存储桶"]。

.步骤
. 输入租户帐户的名称。
+
租户名称不需要是唯一的。创建租户帐户时，它会收到一个唯一的数字帐户 ID。

. 根据您的StorageGRID系统是否使用，定义租户帐户的根访问权限link:using-identity-federation.html["身份联合"]，link:configuring-sso.html["单点登录（SSO）"] ，或两者兼而有之。
+
[cols="1a,2a"]
|===
| 选项 | 执行此操作 


 a| 
如果未启用身份联合
 a| 
指定以本地 root 用户身份登录租户时使用的密码。



 a| 
如果启用了身份联合
 a| 
.. 选择一个现有的联合组link:../tenant/tenant-management-permissions.html["Root访问权限"]对于租户来说。
.. 或者，指定以本地 root 用户身份登录租户时使用的密码。




 a| 
如果同时启用身份联合和单点登录 (SSO)
 a| 
选择一个现有的联合组link:../tenant/tenant-management-permissions.html["Root访问权限"]对于租户来说。没有本地用户可以登录。

|===
. 如果您希望向导为根用户创建访问密钥 ID 和秘密访问密钥，请选择*自动创建根用户 S3 访问密钥*。
+
如果租户的唯一用户是根用户，请选择此选项。如果其他用户要使用此租户，link:../tenant/index.html["使用租户管理器"]配置密钥和权限。

. 如果您现在要为该租户创建存储桶，请选择“为该租户创建存储桶”。
+

TIP: 如果为网格启用了 S3 对象锁，则在此步骤中创建的存储桶未启用 S3 对象锁。如果您需要为此 S3 应用程序使用 S3 对象锁定存储桶，请不要选择现在创建存储桶。相反，使用租户管理器link:../tenant/creating-s3-bucket.html["创建存储桶"]之后。

+
.. 输入 S3 应用程序将使用的存储桶的名称。例如，  `s3-bucket` 。
+
创建存储桶后，您无法更改存储桶名称。

.. 选择此存储桶的*区域*。
+
使用默认区域(`us-east-1`) 除非您期望将来使用 ILM 根据存储桶的区域过滤对象。



. 选择*创建并继续*。




== [[download-data]]第 4 步（共 6 步）：下载数据

在下载数据步骤中，您可以下载一个或两个文件来保存刚刚配置的详细信息。

.步骤
. 如果您选择了“自动创建根用户 S3 访问密钥”，请执行以下操作之一或全部操作：
+
** 选择*下载访问密钥*下载 `.csv`包含租户帐户名称、访问密钥 ID 和秘密访问密钥的文件。
** 选择复制图标 (image:../media/icon_tenant_copy_url.png["复制图标"] ) 将访问密钥 ID 和秘密访问密钥复制到剪贴板。


. 选择*下载配置值*来下载 `.txt`包含负载均衡器端点、租户、存储桶和根用户的设置的文件。
. 将此信息保存到安全的位置。
+

CAUTION: 在复制两个访问密钥之前，请勿关闭此页面。关闭此页面后，密钥将不可用。确保将此信息保存在安全的位置，因为它可用于从StorageGRID系统获取数据。

. 如果出现提示，请选中复选框以确认您已下载或复制密钥。
. 选择“*继续*”转到 ILM 规则和策略步骤。




== 第 5 步（共 6 步）：查看 S3 的 ILM 规则和 ILM 策略

信息生命周期管理 (ILM) 规则控制StorageGRID系统中所有对象的放置、持续时间和摄取行为。 StorageGRID附带的 ILM 策略为所有对象制作了两个副本。此策略将一直有效，直到您激活至少一项新策略为止。

.步骤
. 查看页面上提供的信息。
. 如果要为属于新租户或存储桶的对象添加具体说明，请创建新规则和新策略。看link:../ilm/access-create-ilm-rule-wizard.html["创建 ILM 规则"]和link:../ilm/ilm-policy-overview.html["使用 ILM 策略"]。
. 选择*我已查看这些步骤并了解我需要做什么*。
. 选中复选框表示您了解下一步该做什么。
. 选择“*继续*”转到“*摘要*”。




== 第 6 步（共 6 步）：审核摘要

.步骤
. 查看摘要。
. 记下后续步骤中的详细信息，这些详细信息描述了连接到 S3 客户端之前可能需要的附加配置。例如，选择“以 root 身份Sign in”将带您进入租户管理器，您可以在其中添加租户用户、创建其他存储桶以及更新存储桶设置。
. 选择*完成*。
. 使用从StorageGRID下载的文件或手动获取的值配置应用程序。

