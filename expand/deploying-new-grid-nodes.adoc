---
permalink: expand/deploying-new-grid-nodes.html 
sidebar: sidebar 
keywords: expansion, add nodes 
summary: 扩展中部署新网格节点的步骤与首次安装网格时使用的步骤相同。您必须先部署所有新的网格节点，然后才能执行扩展。 
---
= 部署新网格节点
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
扩展中部署新网格节点的步骤与首次安装网格时使用的步骤相同。您必须先部署所有新的网格节点，然后才能执行扩展。

扩展网格时，添加的节点不必与现有节点类型匹配。您可以添加 VMware 节点、基于 Linux 容器的节点或设备节点。



== VMware：部署网格节点

您必须在 VMware vSphere 中为要在扩展中添加的每个 VMware 节点部署一个虚拟机。

.步骤
. link:../vmware/deploying-storagegrid-node-as-virtual-machine.html["将新节点部署为虚拟机"]并将其连接到一个或多个StorageGRID网络。
+
部署节点时，您可以选择重新映射节点端口或增加 CPU 或内存设置。

. 部署所有新的 VMware 节点后，link:performing-expansion.html["执行扩展程序"] 。




== Linux：部署网格节点

您可以在新的 Linux 主机或现有的 Linux 主机上部署网格节点。如果您需要额外的 Linux 主机来支持要添加到网格的StorageGRID节点的 CPU、RAM 和存储要求，您可以按照首次安装主机时准备主机的相同方式来准备它们。然后，按照安装期间部署网格节点的相同方式部署扩展节点。

.开始之前
* 您已获得针对您的 Linux 版本安装StorageGRID的说明，并且已查看了硬件和存储要求。
+
** link:../rhel/index.html["在 Red Hat Enterprise Linux 上安装StorageGRID"]
** link:../ubuntu/index.html["在 Ubuntu 或 Debian 上安装StorageGRID"]


* 如果您计划在现有主机上部署新的网格节点，则您已确认现有主机具有足够的 CPU、RAM 和存储容量来容纳额外的节点。
* 您有一个计划来尽量减少故障域。例如，您不应该将所有网关节点部署在单个物理主机上。
+

CAUTION: 在生产部署中，不要在单个物理或虚拟主机上运行多个存储节点。为每个存储节点使用专用主机可提供隔离的故障域。

* 如果StorageGRID节点使用从NetApp ONTAP系统分配的存储，请确认该卷未启用FabricPool分层策略。禁用与StorageGRID节点一起使用的卷的FabricPool分层可简化故障排除和存储操作。


.步骤
. 如果要添加新主机，请访问部署StorageGRID节点的安装说明。
. 要部署新主机，请按照准备主机的说明进行操作。
. 要创建节点配置文件并验证StorageGRID配置，请按照部署网格节点的说明进行操作。
. 如果要向新的 Linux 主机添加节点，请启动StorageGRID主机服务。
. 如果要向现有 Linux 主机添加节点，请使用 storagegrid 主机服务 CLI 启动新节点：``sudo storagegrid node start [<node name\>]``


.完成后
部署所有新网格节点后，您可以link:performing-expansion.html["执行扩展"]。



== 设备：部署存储、网关或非主管理节点

要在设备节点上安装StorageGRID软件，请使用设备中包含的StorageGRID设备安装程序。在扩展中，每个存储设备都充当单个存储节点，每个服务设备都充当单个网关节点或非主管理节点。任何设备都可以连接到电网网络、管理网络和客户端网络。

.开始之前
* 该设备已安装在机架或机柜中，连接到您的网络并打开电源。
* 您已完成 https://docs.netapp.com/us-en/storagegrid-appliances/installconfig/configuring-hardware.html["设置硬件"^]步骤。
+
设置设备硬件包括配置StorageGRID连接（网络链接和 IP 地址）所需的步骤以及启用节点加密、更改 RAID 模式和重新映射网络端口的可选步骤。

* StorageGRID设备安装程序的 IP 配置页面上列出的所有网格网络子网均已在主管理节点上的网格网络子网列表中定义。
* 替换设备上的StorageGRID设备安装程序固件与网格上当前运行的StorageGRID软件版本兼容。如果版本不兼容，则必须升级StorageGRID Appliance Installer 固件。
* 您有一台带有link:../admin/web-browser-requirements.html["支持的网络浏览器"]。
* 您知道分配给设备计算控制器的其中一个 IP 地址。您可以使用任何连接的StorageGRID网络的 IP 地址。


.关于此任务
在设备节点上安装StorageGRID的过程包括以下阶段：

* 您指定或确认主管理节点的 IP 地址和设备节点的名称。
* 您开始安装并等待卷配置和软件安装。
+
在设备安装任务进行到一半时，安装暂停。要恢复安装，您需要登录网格管理器，批准所有网格节点，并完成StorageGRID安装过程。

+

NOTE: 如果您需要一次部署多个设备节点，则可以使用 `configure-sga.py`设备安装脚本。



.步骤
. 打开浏览器，然后输入设备计算控制器的其中一个 IP 地址。
+
`https://_Controller_IP_:8443`

+
出现StorageGRID Appliance Installer 主页。

. 在*主管理节点*连接部分，确定是否需要指定主管理节点的 IP 地址。
+
如果您之前已在此数据中心安装了其他节点，则StorageGRID Appliance Installer 可以自动发现此 IP 地址，假设主管理节点或至少一个配置了 ADMIN_IP 的其他网格节点位于同一子网上。

. 如果未显示此 IP 地址或者您需要更改它，请指定地址：
+
[cols="1a,2a"]
|===
| 选项 | 描述 


 a| 
手动 IP 输入
 a| 
.. 清除“启用管理节点发现”复选框。
.. 手动输入 IP 地址。
.. 单击“保存”。
.. 等待新 IP 地址的连接状态变为准备就绪。




 a| 
自动发现所有已连接的主要管理节点
 a| 
.. 选中“启用管理节点发现”复选框。
.. 等待显示发现的 IP 地址列表。
.. 为将部署此设备存储节点的网格选择主管理节点。
.. 单击“保存”。
.. 等待新 IP 地址的连接状态变为准备就绪。


|===
. 在“*节点名称*”字段中，输入您想要用于此设备节点的名称，然后选择“*保存*”。
+
节点名称分配给StorageGRID系统中的此设备节点。它显示在网格管理器中的节点页面（概览选项卡）上。如果需要，您可以在批准节点时更改名称。

. 在 *安装* 部分，确认当前状态为“准备开始将 _node name_ 安装到具有主管理节点 _admin_ip_ 的网格中”并且 *开始安装* 按钮已启用。
+
如果未启用“*开始安装*”按钮，您可能需要更改网络配置或端口设置。有关说明，请参阅设备的维护说明。

. 从StorageGRID Appliance Installer 主页，选择 *开始安装*。
+
image::../media/appliance_installer_home_start_installation_enabled.gif[本图周围的文字提供说明。]

+
当前状态变为“安装正在进行中”，并显示监控安装页面。

. 如果您的扩展包括多个设备节点，请对每个设备重复上述步骤。
+

NOTE: 如果您需要一次部署多个设备存储节点，则可以使用 configure-sga.py 设备安装脚本自动执行安装过程。

. 如果需要手动访问监视器安装页面，请从菜单栏中选择*监视器安装*。
+
监控安装页面显示安装进度。

+
image::../media/monitor_installation_configure_storage.gif[本图四周的文字提供了相关说明。]

+
蓝色状态栏指示当前正在进行的任务。绿色状态条表示任务已成功完成。

+

NOTE: 安装程序确保不会重新运行以前安装中完成的任务。如果您重新运行安装，任何不需要重新运行的任务都会显示绿色状态栏和“已跳过”状态。

. 回顾前两个安装阶段的进度。
+
*1.配置设备*

+
在此阶段，将发生以下过程之一：

+
** 对于存储设备，安装程序连接到存储控制器，清除任何现有配置，与SANtricity OS 通信以配置卷，并配置主机设置。
** 对于服务设备，安装程序会清除计算控制器中驱动器的所有现有配置，并配置主机设置。
+
*2.安装操作系统*

+
在此阶段，安装程序将StorageGRID的基本操作系统映像复制到设备。



. 继续监视安装进度，直到控制台窗口中出现一条消息，提示您使用网格管理器批准该节点。
+

NOTE: 等到您在此扩展中添加的所有节点都准备好批准后，再转到网格管理器批准节点。

+
image::../media/monitor_installation_install_sgws.gif[本图四周的文字提供了相关说明。]


