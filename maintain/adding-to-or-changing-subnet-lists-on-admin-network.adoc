---
permalink: maintain/adding-to-or-changing-subnet-lists-on-admin-network.html 
sidebar: sidebar 
keywords: storagegrid, subnet list, admin network 
summary: 您可以添加、删除或更改一个或多个节点的管理网络子网列表中的子网。 
---
= 添加或更改管理网络上的子网列表
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以添加、删除或更改一个或多个节点的管理网络子网列表中的子网。

.开始之前
* 你有 `Passwords.txt`文件。


您可以向管理网络子网列表上的所有节点添加、删除或更改子网。

[NOTE]
====
请勿将包含以下 IPv4 地址的子网用于任何节点的网格网络、管理网络或客户端网络：

* 192,168,130,101
* 192,168,131,101
* 192,168,130,102
* 192,168,131,102
* 198.51.100.2
* 198.51.100.4


例如，不要对任何节点的网格网络、管理网络或客户端网络使用以下子网范围：

* 192.168.130.0/24，因为此子网范围包含 IP 地址 192.168.130.101 和 192.168.130.102
* 192.168.131.0/24，因为此子网范围包含 IP 地址 192.168.131.101 和 192.168.131.102
* 198.51.100.0/24，因为此子网范围包含 IP 地址 198.51.100.2 和 198.51.100.4


====
.步骤
. 登录到主管理节点：
+
.. 输入以下命令： `ssh admin@_primary_Admin_Node_IP_`
.. 输入 `Passwords.txt`文件。
.. 输入以下命令切换到root： `su -`
.. 输入 `Passwords.txt`文件。


+
当您以 root 身份登录时，提示符将从 `$`到 `#`。

. 输入以下命令启动更改 IP 工具： `change-ip`
. 在提示符下输入配置密码。
+
出现主菜单。

+
image::../media/change_ip_tool_main_menu.png[屏幕截图显示了更改 IP 工具的欢迎屏幕]

. 或者，限制执行操作的网络/节点。选择下列选项之一：
+
** 如果您想要过滤要执行操作的特定节点，请选择 *1* 来选择要编辑的节点。从下列选项中选择一项：
+
*** *1*：单个节点（按名称选择）
*** *2*：单节点（按站点选择，然后按名称选择）
*** *3*: 单节点（按当前IP选择）
*** *4*：站点上的所有节点
*** *5*：网格中的所有节点
*** *0*：返回


** 允许“全部”保持选中状态。选择完成后，将出现主菜单屏幕。选定节点字段反映了您的新选择，现在所有选定的操作将仅对此项目执行。


. 在主菜单上，选择编辑管理网络子网的选项（选项*3*）。
. 选择下列选项之一：
+
--
** 通过输入以下命令添加子网： `add CIDR`
** 输入以下命令删除子网： `del CIDR`
** 通过输入以下命令设置子网列表： `set CIDR`


--
+
--

NOTE: 对于所有命令，您可以使用以下格式输入多个地址： `add CIDR, CIDR`

例子： `add 172.14.0.0/16, 172.15.0.0/16, 172.16.0.0/16`


TIP: 您可以使用“向上箭头”将以前输入的值调用到当前输入提示中，然后在必要时对其进行编辑，从而减少所需的输入量。

下面的示例输入显示将子网添加到管理网络子网列表：

image::../media/change_ip_tool_aesl_sample_input.gif[更改 ip 工具 aesl 示例]

--
. 准备就绪后，输入 *q* 返回主菜单屏幕。您的更改将保留，直到被清除或应用为止。
+

NOTE: 如果您在步骤 2 中选择了任何“全部”节点选择模式，请按 *Enter*（不带 *q*）转到列表中的下一个节点。

. 选择下列选项之一：
+
** 选择选项 *5* 以在隔离的输出中显示编辑，仅显示更改的项目。更改以绿色（添加）或红色（删除）突出显示，如下面的示例输出所示：
+
image::../media/change_ip_tool_aesl_sample_output.png[屏幕截图由周围文字描述]

** 选择选项 *6* 以在显示完整配置的输出中显示编辑。更改以绿色（添加）或红色（删除）突出显示。  *注意：*某些终端仿真器可能会使用删除线格式显示添加和删除。
+
当您尝试更改子网列表时，会显示以下消息：

+
[listing]
----
CAUTION: The Admin Network subnet list on the node might contain /32 subnets derived from automatically applied routes that aren't persistent. Host routes (/32 subnets) are applied automatically if the IP addresses provided for external services such as NTP or DNS aren't reachable using default StorageGRID routing, but are reachable using a different interface and gateway. Making and applying changes to the subnet list will make all automatically applied subnets persistent. If you don't want that to happen, delete the unwanted subnets before applying changes. If you know that all /32 subnets in the list were added intentionally, you can ignore this caution.
----
+
如果您没有专门将 NTP 和 DNS 服务器子网分配给网络， StorageGRID会自动为连接创建主机路由 (/32)。例如，如果您希望使用 /16 或 /24 路由​​来与 DNS 或 NTP 服务器建立出站连接，则应删除自动创建的 /32 路由并添加所需的路由。如果您不删除自动创建的主机路由，则在对子网列表应用任何更改后，它将保留下来。



+

NOTE: 虽然您可以使用这些自动发现的主机路由，但通常您应该手动配置 DNS 和 NTP 路由以确保连接。

. 选择选项 *7* 来验证所有阶段性变更。
+
此验证确保遵守网格、管理和客户端网络的规则，例如使用重叠子网。

. 或者，选择选项 *8* 保存所有阶段性更改并稍后返回继续进行更改。
+
此选项允许您退出更改 IP 工具并稍后重新启动，而不会丢失任何未应用的更改。

. 执行以下操作之一：
+
** 如果您想清除所有更改而不保存或应用新的网络配置，请选择选项*9*。
** 如果您准备好应用更改并提供新的网络配置，请选择选项*10*。在配置期间，输出显示应用更新的状态，如以下示例输出所示：
+
[listing]
----
Generating new grid networking description file...

Running provisioning...

Updating grid network configuration on Name
----


. 从网格管理器下载新的恢复包。
+
.. 选择*维护* > *系统* > *恢复包*。
.. 输入配置密码。



