---
permalink: maintain/adding-to-or-changing-subnet-lists-on-grid-network.html 
sidebar: sidebar 
keywords: storagegrid, subnet list, grid network 
summary: 您可以使用更改 IP 工具在网格网络中添加或更改子网。 
---
= 在网格网络上添加或更改子网列表
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以使用更改 IP 工具在网格网络中添加或更改子网。

.开始之前
* 你有 `Passwords.txt`文件。


您可以在网格网络子网列表中添加、删除或更改子网。变化将影响网格中所有节点的路由。


NOTE: 如果您仅对网格网络子网列表进行更改，请使用网格管理器添加或更改网络配置。否则，如果由于网络配置问题而无法访问网格管理器，或者您同时执行网格网络路由更改和其他网络更改，请使用更改 IP 工具。

[NOTE]
====
请勿将包含以下 IPv4 地址的子网用于任何节点的网格网络、管理网络或客户端网络：

* 192,168,130,101
* 192,168,131,101
* 192,168,130,102
* 192,168,131,102
* 198.51.100.2
* 198.51.100.4


例如，不要对任何节点的网格网络、管理网络或客户端网络使用以下子网范围：

* 192.168.130.0/24，因为此子网范围包含 IP 地址 192.168.130.101 和 192.168.130.102
* 192.168.131.0/24，因为此子网范围包含 IP 地址 192.168.131.101 和 192.168.131.102
* 198.51.100.0/24，因为此子网范围包含 IP 地址 198.51.100.2 和 198.51.100.4


====
.步骤
. 登录到主管理节点：
+
.. 输入以下命令： `ssh admin@_primary_Admin_Node_IP_`
.. 输入 `Passwords.txt`文件。
.. 输入以下命令切换到root： `su -`
.. 输入 `Passwords.txt`文件。


+
当您以 root 身份登录时，提示符将从 `$`到 `#`。

. 输入以下命令启动更改 IP 工具： `change-ip`
. 在提示符下输入配置密码。
+
出现主菜单。

+
image::../media/change_ip_tool_main_menu.png[屏幕截图显示了更改 IP 工具的欢迎屏幕]

. 在主菜单上，选择编辑电网子网的选项（选项*4*）。
+

NOTE: 电网子网列表的更改是整个电网范围内的。

. 选择下列选项之一：
+
--
** 通过输入以下命令添加子网： `add CIDR`
** 输入以下命令删除子网： `del CIDR`
** 通过输入以下命令设置子网列表： `set CIDR`


--
+
--

NOTE: 对于所有命令，您可以使用以下格式输入多个地址： `add CIDR, CIDR`

例子： `add 172.14.0.0/16, 172.15.0.0/16, 172.16.0.0/16`


TIP: 您可以使用“向上箭头”将以前输入的值调用到当前输入提示中，然后在必要时对其进行编辑，从而减少所需的输入量。

下面的示例输入显示了为网格网络子网列表设置子网：

image::../media/change_ip_tool_gnsl_sample_input.gif[屏幕截图由周围文字描述]

--
. 准备就绪后，输入 *q* 返回主菜单屏幕。您的更改将保留，直到被清除或应用为止。
. 选择下列选项之一：
+
** 选择选项 *5* 以在隔离的输出中显示编辑，仅显示更改的项目。更改以绿色（添加）或红色（删除）突出显示，如下面的示例输出所示：
+
image::../media/change_ip_tool_gnsl_sample_output.gif[屏幕截图由周围文字描述]

** 选择选项 *6* 以在显示完整配置的输出中显示编辑。更改以绿色（添加）或红色（删除）突出显示。
+

NOTE: 某些命令行界面可能会使用删除线格式显示添加和删除的内容。



. 选择选项 *7* 来验证所有阶段性变更。
+
此验证确保遵守网格、管理和客户端网络的规则，例如使用重叠子网。

. 或者，选择选项 *8* 保存所有阶段性更改并稍后返回继续进行更改。
+
此选项允许您退出更改 IP 工具并稍后重新启动，而不会丢失任何未应用的更改。

. 执行以下操作之一：
+
** 如果您想清除所有更改而不保存或应用新的网络配置，请选择选项*9*。
** 如果您准备好应用更改并提供新的网络配置，请选择选项*10*。在配置期间，输出显示应用更新的状态，如以下示例输出所示：
+
[listing]
----
Generating new grid networking description file...

Running provisioning...

Updating grid network configuration on Name
----


. 如果在进行电网更改时选择了选项 *10*，请选择以下选项之一：
+
** *应用*：立即应用更改，并在必要时自动重启每个节点。
+
如果新的网络配置将与旧的网络配置同时运行而无需任何外部更改，则可以使用 *apply* 选项进行完全自动化的配置更改。

** *stage*：下次重启节点时应用更改。
+
如果需要对物理或虚拟网络配置进行更改以使新的网络配置正常运行，则必须使用 *stage* 选项，关闭受影响的节点，进行必要的物理网络更改，然后重新启动受影响的节点。

+

NOTE: 如果您使用 *stage* 选项，请在暂存后尽快重新启动节点以尽量减少中断。

** *取消*：此时不要进行任何网络更改。
+
如果您不知道所提议的更改需要重新启动节点，您可以推迟更改以尽量减少对用户的影响。选择“*取消*”将返回主菜单并保存您的更改，以便您稍后应用它们。



+
应用或阶段更改后，将根据网格配置更改生成新的恢复包。

. 如果由于错误而停止配置，则可以使用以下选项：
+
** 要终止 IP 更改过程并返回主菜单，请输入 *a*。
** 要重试失败的操作，请输入 *r*。
** 要继续下一个操作，请输入 *c*。
+
可以通过从主菜单中选择选项 *10*（应用更改）来稍后重试失败的操作。直到所有操作成功完成后，IP 更改过程才算完成。

** 如果您必须手动干预（例如重新启动节点）并且确信工具认为失败的操作实际上已成功完成，请输入 *f* 将其标记为成功并转到下一个操作。


. 从网格管理器下载新的恢复包。
+
.. 选择*维护* > *系统* > *恢复包*。
.. 输入配置密码。


+

CAUTION: 恢复包文件必须是安全的，因为它包含可用于从StorageGRID系统获取数据的加密密钥和密码。


