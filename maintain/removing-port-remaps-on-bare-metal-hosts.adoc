---
permalink: maintain/removing-port-remaps-on-bare-metal-hosts.html 
sidebar: sidebar 
keywords: storagegrid, recover, linux, linux host, bare metal host, baremetal host, remove port remap, removing port remap, port remap 
summary: 如果要为负载均衡器服务配置端点，并且要使用已配置为端口重映射的映射到端口的端口，则必须先删除现有的端口重映射，否则端点将无效。 
---
= 删除裸机主机上的端口重新映射
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
如果要为负载均衡器服务配置端点，并且要使用已配置为端口重映射的映射到端口的端口，则必须先删除现有的端口重映射，否则端点将无效。

.关于此任务
如果您在裸机主机上运行StorageGRID ，请按照此过程操作，而不是按照删除端口重新映射的常规过程操作。您必须编辑具有冲突的重新映射端口的每个管理节点和网关节点的节点配置文件，以删除所有节点的端口重新映射并重新启动该节点。


CAUTION: 此过程将删除所有端口重新映射。如果您需要保留一些重新映射，请联系技术支持。

有关配置负载均衡器端点的信息，请参阅管理StorageGRID的说明。


NOTE: 由于节点重新启动，此过程可能会导致服务暂时丢失。

.步骤
. 登录支持该节点的主机。以 root 身份或具有 sudo 权限的帐户登录。
. 运行以下命令暂时禁用该节点： `sudo storagegrid node stop _node-name_`
. 使用文本编辑器（例如 vim 或 pico）编辑节点的节点配置文件。
+
节点配置文件可以在以下位置找到 `/etc/storagegrid/nodes/_node-name_.conf`。

. 找到包含端口重新映射的节点配置文件部分。
+
请参见以下示例中的最后两行。

+
[listing, subs="specialcharacters,quotes"]
----
ADMIN_NETWORK_CONFIG = STATIC
ADMIN_NETWORK_ESL = 10.0.0.0/8, 172.19.0.0/16, 172.21.0.0/16
ADMIN_NETWORK_GATEWAY = 10.224.0.1
ADMIN_NETWORK_IP = 10.224.5.140
ADMIN_NETWORK_MASK = 255.255.248.0
ADMIN_NETWORK_MTU = 1400
ADMIN_NETWORK_TARGET = eth1
ADMIN_NETWORK_TARGET_TYPE = Interface
BLOCK_DEVICE_VAR_LOCAL = /dev/sda2
CLIENT_NETWORK_CONFIG = STATIC
CLIENT_NETWORK_GATEWAY = 47.47.0.1
CLIENT_NETWORK_IP = 47.47.5.140
CLIENT_NETWORK_MASK = 255.255.248.0
CLIENT_NETWORK_MTU = 1400
CLIENT_NETWORK_TARGET = eth2
CLIENT_NETWORK_TARGET_TYPE = Interface
GRID_NETWORK_CONFIG = STATIC
GRID_NETWORK_GATEWAY = 192.168.0.1
GRID_NETWORK_IP = 192.168.5.140
GRID_NETWORK_MASK = 255.255.248.0
GRID_NETWORK_MTU = 1400
GRID_NETWORK_TARGET = eth0
GRID_NETWORK_TARGET_TYPE = Interface
NODE_TYPE = VM_API_Gateway
*PORT_REMAP = client/tcp/8082/443*
*PORT_REMAP_INBOUND = client/tcp/8082/443*
----
. 编辑 PORT_REMAP 和 PORT_REMAP_INBOUND 条目以删除端口重新映射。
+
[listing]
----
PORT_REMAP =
PORT_REMAP_INBOUND =
----
. 运行以下命令来验证对节点的节点配置文件的更改：``sudo storagegrid node validate _node-name_``
+
在继续下一步之前，请解决所有错误或警告。

. 运行以下命令重新启动节点而不进行端口重新映射： `sudo storagegrid node start _node-name_`
. 使用列出的密码以管理员身份登录节点 `Passwords.txt`文件。
. 验证服务是否正确启动。
+
.. 查看服务器上所有服务的状态列表：``sudo storagegrid-status``
+
状态会自动更新。

.. 等到所有服务的状态都变为“正在运行”或“已验证”。
.. 退出状态屏幕：``Ctrl+C``


. 在每个具有冲突的重新映射端口的管理节点和网关节点上重复这些步骤。

