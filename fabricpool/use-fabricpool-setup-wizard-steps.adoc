---
permalink: fabricpool/use-fabricpool-setup-wizard-steps.html 
sidebar: sidebar 
keywords: fabricPool, FabricPool setup wizard, ontap system manager 
summary: 您可以使用FabricPool设置向导将StorageGRID配置为FabricPool云层的对象存储系统。 
---
= 访问并完成FabricPool设置向导
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以使用FabricPool设置向导将StorageGRID配置为FabricPool云层的对象存储系统。

.开始之前
* 您已审阅link:../fabricpool/use-fabricpool-setup-wizard.html["注意事项和要求"]使用FabricPool设置向导。
+

NOTE: 如果要配置StorageGRID以用于任何其他 S3 客户端应用程序，请转至link:../admin/use-s3-setup-wizard.html["使用 S3 设置向导"]。

* 你有link:../admin/admin-group-permissions.html["Root访问权限"]。




== 访问向导

您可以在开始使用StorageGRID Grid Manager 时完成FabricPool设置向导，也可以在以后的任何时间访问并完成该向导。

.步骤
. Sign inlink:../admin/web-browser-requirements.html["支持的网络浏览器"]。
. 如果仪表板上出现 * FabricPool和 S3 设置向导* 横幅，请选择横幅中的链接。如果横幅不再出现，请从网格管理器的标题栏中选择帮助图标，然后选择* FabricPool和 S3 设置向导*。
+
image::../media/help_menu.png[帮助菜单]

. 在FabricPool和 S3 设置向导页面的FabricPool部分中，选择 *立即配置*。
+
出现*第 1 步（共 9 步）：配置 HA 组*。





== 步骤 1（共 9 步）：配置 HA 组

高可用性 (HA) 组是每个包含StorageGRID负载均衡器服务的节点集合。  HA 组可以包含网关节点、管理节点或两者。

您可以使用 HA 组来帮助保持FabricPool数据连接可用。 HA 组使用虚拟 IP 地址 (VIP) 来提供对负载均衡器服务的高度可用访问。如果 HA 组中的活动接口发生故障，则备用接口可以管理工作负载，而不会对FabricPool操作产生太大影响

有关此任务的详细信息，请参阅link:../admin/managing-high-availability-groups.html["管理高可用性组"]和link:best-practices-for-high-availability-groups.html["高可用性组的最佳实践"]。

.步骤
. 如果您计划使用外部负载均衡器，则无需创建 HA 组。选择“跳过此步骤”并前往<<步骤 2（共 9 步）：配置负载均衡器端点>>。
. 要使用StorageGRID负载均衡器，请创建一个新的 HA 组或使用现有的 HA 组。
+
[role="tabbed-block"]
====
.创建 HA 组
--
.. 要创建新的 HA 组，请选择*创建 HA 组*。
.. 对于*输入详细信息*步骤，请填写以下字段。
+
[cols="1a,3a"]
|===
| 字段 | 描述 


 a| 
HA组名称
 a| 
此 HA 组的唯一显示名称。



 a| 
描述（可选）
 a| 
该 HA 组的描述。

|===
.. 对于*添加接口*步骤，选择您想要在此 HA 组中使用的节点接口。
+
使用列标题对行进行排序，或输入搜索词以更快地找到接口。

+
您可以选择一个或多个节点，但每个节点只能选择一个接口。

.. 对于*优先考虑接口*步骤，确定此 HA 组的主接口和任何备份接口。
+
拖动行来更改“优先级顺序”列中的值。

+
列表中的第一个接口是主接口。除非发生故障，否则主接口是活动接口。

+
如果 HA 组包含多个接口并且活动接口出现故障，则虚拟 IP (VIP) 地址将按优先级顺序移动到第一个备份接口。如果该接口出现故障，VIP 地址将移动到下一个备份接口，依此类推。当故障解决后，VIP 地址将移回可用的最高优先级接口。

.. 对于*输入 IP 地址*步骤，请填写以下字段。
+
[cols="1a,3a"]
|===
| 字段 | 描述 


 a| 
子网 CIDR
 a| 
CIDR 表示法中的 VIP 子网地址——IPv4 地址后跟斜杠和子网长度（0-32）。

网络地址不得设置任何主机位。例如，  `192.16.0.0/22` 。



 a| 
网关 IP 地址（可选）
 a| 
可选。如果用于访问StorageGRID 的ONTAP IP 地址与StorageGRID VIP 地址不在同一子网中，请输入StorageGRID VIP 本地网关 IP 地址。本地网关IP地址必须在VIP子网内。



 a| 
虚拟 IP 地址
 a| 
为 HA 组中的活动接口输入至少一个、最多十个 VIP 地址。所有 VIP 地址都必须位于 VIP 子网内，并且所有 VIP 地址都将在活动接口上同时处于活动状态。

至少一个地址必须是 IPv4。您也可以选择指定其他 IPv4 和 IPv6 地址。

|===
.. 选择“创建 HA 组”，然后选择“完成”返回FabricPool设置向导。
.. 选择“*继续*”进入负载均衡器步骤。


--
.使用现有的 HA 组
--
.. 要使用现有的 HA 组，请从*选择 HA 组*下拉列表中选择 HA 组名称。
.. 选择“*继续*”进入负载均衡器步骤。


--
====




== 步骤 2（共 9 步）：配置负载均衡器端点

StorageGRID使用负载均衡器来管理来自客户端应用程序（例如FabricPool）的工作负载。负载平衡可最大限度地提高多个存储节点的速度和连接容量。

您可以使用所有网关和管理节点上存在的StorageGRID负载均衡器服务，也可以连接到外部（第三方）负载均衡器。建议使用StorageGRID负载均衡器。

有关此任务的详细信息，请参阅常规link:../admin/managing-load-balancing.html["负载平衡的注意事项"]以及link:best-practices-for-load-balancing.html["FabricPool负载平衡的最佳实践"]。

.步骤
. 选择或创建StorageGRID负载均衡器端点或使用外部负载均衡器。
+
[role="tabbed-block"]
====
.创建端点
--
.. 选择*创建端点*。
.. 对于*输入端点详细信息*步骤，请填写以下字段。
+
[cols="1a,3a"]
|===
| 字段 | 描述 


 a| 
名称
 a| 
端点的描述性名称。



 a| 
端口
 a| 
您想要用于负载平衡的StorageGRID端口。对于您创建的第一个端点，此字段默认为 10433，但您可以输入任何未使用的外部端口。如果输入 80 或 443，则端点仅在网关节点上配置，因为这些端口在管理节点上保留。

*注意：*不允许使用其他网格服务使用的端口。查看link:../network/internal-grid-node-communications.html["网络端口参考"]。



 a| 
客户端类型
 a| 
必须是*S3*。



 a| 
网络协议
 a| 
选择 *HTTPS*。

*注意*：支持但不建议使用没有 TLS 加密的StorageGRID进行通信。

|===
.. 对于*选择绑定模式*步骤，指定绑定模式。绑定模式控制如何使用任意 IP 地址或使用特定 IP 地址和网络接口访问端点。
+
[cols="1a,3a"]
|===
| 模式 | 描述 


 a| 
全局（默认）
 a| 
客户端可以使用任何网关节点或管理节点的 IP 地址、任何网络上任何 HA 组的虚拟 IP (VIP) 地址或相应的 FQDN 访问端点。

除非您需要限制此端点的可访问性，否则请使用*全局*设置（默认）。



 a| 
HA 组的虚拟 IP
 a| 
客户端必须使用 HA 组的虚拟 IP 地址（或相应的 FQDN）来访问此端点。

具有此绑定模式的端点都可以使用相同的端口号，只要您为端点选择的 HA 组不重叠。



 a| 
节点接口
 a| 
客户端必须使用选定节点接口的 IP 地址（或相应的 FQDN）来访问此端点。



 a| 
节点类型
 a| 
根据您选择的节点类型，客户端必须使用任何管理节点的 IP 地址（或相应的 FQDN）或任何网关节点的 IP 地址（或相应的 FQDN）来访问此端点。

|===
.. 对于“租户访问”步骤，选择以下选项之一：
+
[cols="1a,3a"]
|===
| 字段 | 描述 


 a| 
允许所有租户（默认）
 a| 
所有租户帐户都可以使用此端点访问他们的存储桶。

*允许所有租户*几乎始终是用于FabricPool的负载均衡器端点的适当选项。

如果您正在使用FabricPool设置向导为新的StorageGRID系统设置并且尚未创建任何租户帐户，则必须选择此选项。



 a| 
允许选定的租户
 a| 
只有选定的租户帐户可以使用此端点访问其存储桶。



 a| 
阻止选定的租户
 a| 
选定的租户帐户不能使用此端点访问其存储桶。所有其他租户都可以使用此端点。

|===
.. 对于*附加证书*步骤，选择以下之一：
+
[cols="1a,3a"]
|===
| 字段 | 描述 


 a| 
上传证书（推荐）
 a| 
使用此选项上传 CA 签名的服务器证书、证书私钥和可选的 CA 包。



 a| 
生成证书
 a| 
使用此选项生成自签名证书。看link:../admin/configuring-load-balancer-endpoints.html["配置负载均衡器端点"]了解输入内容的详细信息。



 a| 
使用StorageGRID S3 证书
 a| 
仅当您已上传或生成StorageGRID全局证书的自定义版本时，此选项才可用。看link:../admin/configuring-custom-server-certificate-for-storage-node.html["配置 S3 API 证书"]了解详情。

|===
.. 选择“*完成*”返回FabricPool设置向导。
.. 选择“*继续*”进入租户和存储桶步骤。



NOTE: 对端点证书的更改最多可能需要 15 分钟才能应用到所有节点。

--
.使用现有的负载均衡器端点
--
.. 从“选择负载均衡器端点”下拉列表中选择现有端点的名称。
.. 选择“*继续*”进入租户和存储桶步骤。


--
.使用外部负载均衡器
--
.. 填写外部负载均衡器的以下字段。
+
[cols="1a,3a"]
|===
| 字段 | 描述 


 a| 
FQDN
 a| 
外部负载均衡器的完全限定域名 (FQDN)。



 a| 
端口
 a| 
FabricPool将用于连接外部负载均衡器的端口号。



 a| 
证书
 a| 
复制外部负载均衡器的服务器证书并将其粘贴到此字段中。

|===
.. 选择“*继续*”进入租户和存储桶步骤。


--
====




== 第 3 步（共 9 步）：租户和存储桶

租户是可以使用 S3 应用程序在StorageGRID中存储和检索对象的实体。每个租户都有自己的用户、访问密钥、存储桶、对象和一组特定的功能。您必须先创建StorageGRID租户，然后才能创建FabricPool将使用的存储桶。

bucket 是用于存储租户的对象和对象元数据的容器。尽管某些租户可能有许多存储桶，但向导允许您一次只创建或选择一个租户和一个存储桶。您可以稍后使用租户管理器添加所需的任何其他存储桶。

您可以为FabricPool使用创建一个新的租户和存储桶，也可以选择一个现有的租户和存储桶。如果您创建新的租户，系统会自动为租户的根用户创建访问密钥 ID 和秘密访问密钥。

有关此任务的详细信息，请参阅link:creating-tenant-account-for-fabricpool.html["为FabricPool创建租户帐户"]和link:creating-s3-bucket-and-access-key.html["创建 S3 存储桶并获取访问密钥"]。

.步骤
创建新的租户和存储桶或选择现有租户。

[role="tabbed-block"]
====
.新租户和存储桶
--
. 要创建新的租户和存储桶，请输入*租户名称*。例如，  `FabricPool tenant` 。
. 根据您的StorageGRID系统是否使用，定义租户帐户的根访问权限link:../admin/using-identity-federation.html["身份联合"]，link:../admin/configuring-sso.html["单点登录（SSO）"] ，或两者兼而有之。
+
[cols="1a,3a"]
|===
| 选项 | 执行此操作 


 a| 
如果未启用身份联合
 a| 
指定以本地 root 用户身份登录租户时使用的密码。



 a| 
如果启用了身份联合
 a| 
.. 选择一个现有的联合组，为租户提供 Root 访问权限。
.. 或者，指定以本地 root 用户身份登录租户时使用的密码。




 a| 
如果同时启用身份联合和单点登录 (SSO)
 a| 
选择一个现有的联合组，为租户提供 Root 访问权限。没有本地用户可以登录。

|===
. 对于 *Bucket name*，输入FabricPool将用于存储ONTAP数据的存储桶的名称。例如，  `fabricpool-bucket` 。
+

TIP: 创建存储桶后，您无法更改存储桶名称。

. 选择此存储桶的*区域*。
+
使用默认区域(`us-east-1`) 除非您期望将来使用 ILM 根据存储桶的区域过滤对象。

. 选择“创建并继续”以创建租户和存储桶，然后转到下载数据步骤


--
.选择租户和存储桶
--
现有租户帐户必须至少有一个未启用版本控制的存储桶。如果不存在适合该租户的存储桶，则您无法选择现有租户帐户。

. 从“租户名称”下拉列表中选择现有租户。
. 从“存储桶名称”下拉列表中选择现有的存储桶。
+
FabricPool不支持对象版本控制，因此不会显示启用了版本控制的存储桶。

+

NOTE: 不要选择已启用 S3 对象锁以与FabricPool一起使用的存储桶。

. 选择*继续*进入下载数据步骤。


--
====


== 步骤 4（共 9 步）：下载ONTAP设置

在此步骤中，您将下载一个文件，可以使用该文件将值输入ONTAP系统管理器。

.步骤
. 或者，选择复制图标 (image:../media/icon_tenant_copy_url.png["复制图标"] ) 将访问密钥 ID 和秘密访问密钥复制到剪贴板。
+
这些值包含在下载文件中，但您可能希望单独保存它们。

. 选择“下载ONTAP设置”以下载包含您迄今为止输入的值的文本文件。
+
这 `ONTAP_FabricPool_settings___bucketname__.txt`文件包含将StorageGRID配置为FabricPool云层的对象存储系统所需的信息，包括：

+
** 负载均衡器连接详细信息，包括服务器名称 (FQDN)、端口和证书
** 存储桶名称
** 租户帐户的根用户的访问密钥 ID 和秘密访问密钥


. 将复制的密钥和下载的文件保存到安全的位置。
+

CAUTION: 在复制两个访问密钥、下载ONTAP设置或两者之前，请勿关闭此页面。关闭此页面后，密钥将不可用。确保将此信息保存在安全的位置，因为它可用于从StorageGRID系统获取数据。

. 选中复选框以确认您已下载或复制访问密钥 ID 和秘密访问密钥。
. 选择“*继续*”进入 ILM 存储池步骤。




== 第 5 步（共 9 步）：选择存储池

存储池是一组存储节点。当您选择存储池时，您可以确定StorageGRID将使用哪些节点来存储从ONTAP分层的数据。

有关此步骤的详细信息，请参阅link:../ilm/creating-storage-pool.html["创建存储池"]。

.步骤
. 从“*站点*”下拉列表中，选择要用于ONTAP分层数据的StorageGRID站点。
. 从*存储池*下拉列表中，选择该站点的存储池。
+
站点的存储池包括该站点的所有存储节点。

. 选择“*继续*”进入 ILM 规则步骤。




== 第 6 步（共 9 步）：查看FabricPool的 ILM 规则

信息生命周期管理 (ILM) 规则控制StorageGRID系统中所有对象的放置、持续时间和摄取行为。

FabricPool设置向导会自动创建供FabricPool使用的建议 ILM 规则。此规则仅适用于您指定的存储桶。它在单个站点使用 2+1 擦除编码来存储从ONTAP分层的数据。

有关此步骤的详细信息，请参阅link:../ilm/access-create-ilm-rule-wizard.html["创建 ILM 规则"]和link:best-practices-ilm.html["将 ILM 与FabricPool数据结合使用的最佳实践"]。

.步骤
. 查看规则详细信息。
+
[cols="1a,3a"]
|===
| 字段 | 描述 


 a| 
规则名称
 a| 
自动生成且无法更改



 a| 
描述
 a| 
自动生成且无法更改



 a| 
筛选器
 a| 
存储桶名称

此规则仅适用于保存在您指定的存储桶中的对象。



 a| 
参考时间
 a| 
摄取时间

当对象最初保存到存储桶时，放置指令就开始了。



 a| 
安置指导
 a| 
使用 2+1 擦除编码

|===
. 将保留图按*时间段*和*存储池*排序，以确认放置指令。
+
** 该规则的*时间段*是*第 0 天 - 永远*。  *第 0 天* 表示当数据从ONTAP分层时应用该规则。  *永远* 意味着StorageGRID ILM 不会删除已从ONTAP分层的数据。
** 该规则的*存储池*是您选择的存储池。 *EC 2+1* 表示数据将使用 2+1 擦除编码存储。每个对象将保存为两个数据片段和一个奇偶校验片段。每个对象的三个片段将保存到单个站点的不同存储节点。


. 选择*创建并继续*来创建此规则并转到 ILM 策略步骤。




== 第 7 步（共 9 步）：审查并激活 ILM 策略

FabricPool设置向导为FabricPool创建 ILM 规则后，它会创建一个 ILM 策略。在激活此策略之前，您必须仔细模拟并审查此策略。

有关此步骤的详细信息，请参阅link:../ilm/creating-ilm-policy.html["创建 ILM 策略"]和link:best-practices-ilm.html["将 ILM 与FabricPool数据结合使用的最佳实践"]。


CAUTION: 当您激活新的 ILM 策略时， StorageGRID使用该策略来管理网格中所有对象（包括现有对象和新摄取的对象）的放置、持续时间和数据保护。在某些情况下，激活新策略可能会导致现有对象移动到新位置。


CAUTION: 为避免数据丢失，请勿使用将过期或删除FabricPool云层数据的 ILM 规则。将保留期设置为*永久*，以确保FabricPool对象不会被StorageGRID ILM 删除。

.步骤
. 或者，更新系统生成的*策略名称*。默认情况下，系统会在活动或非活动策略的名称后附加“+ FabricPool”，但您可以提供自己的名称。
. 查看非活动策略中的规则列表。
+
** 如果您的网格没有非活动的 ILM 策略，向导将通过克隆您的活动策略并将新规则添加到顶部来创建非活动策略。
** 如果您的网格已经有一个非活动的 ILM 策略，并且该策略使用与活动 ILM 策略相同的规则和顺序，则向导会将新规则添加到非活动策略的顶部。
** 如果您的非活动策略包含与活动策略不同的规则或不同的顺序，则向导将通过克隆活动策略并将新规则添加到顶部来创建新的非活动策略。


. 检查新的非活动策略中的规则顺序。
+
由于FabricPool规则是第一条规则，因此FabricPool存储桶中的任何对象都会被放置在策略中的其他规则评估之前。任何其他存储桶中的对象均按照策略中的后续规则放置。

. 查看保留图以了解如何保留不同的对象。
+
.. 选择“展开全部”以查看非活动策略中每个规则的保留图。
.. 选择*时间段*和*存储池*来查看保留图。确认适用于FabricPool存储桶或租户的任何规则都*永久*保留对象。


. 当您查看了非活动策略后，选择*激活并继续*以激活该策略并转到流量分类步骤。



CAUTION: ILM 策略中的错误可能会导致无法挽回的数据丢失。激活之前请仔细查看政策。



== 第 8 步（共 9 步）：创建流量分类策略

作为一种选择， FabricPool设置向导可以创建一个流量分类策略，您可以使用该策略来监控FabricPool工作负载。系统创建的策略使用匹配规则来识别与您创建的存储桶相关的所有网络流量。此策略仅监控流量；它不限制FabricPool或任何其他客户端的流量。

有关此步骤的详细信息，请参阅link:creating-traffic-classification-policy-for-fabricpool.html["为FabricPool创建流量分类策略"]。

.步骤
. 审查该政策。
. 如果要创建此流量分类策略，请选择*创建并继续*。
+
一旦FabricPool开始将数据分层到StorageGRID，您就可以转到“流量分类策略”页面查看此策略的网络流量指标。之后，您还可以添加规则来限制其他工作负载，并确保FabricPool工作负载拥有大部分带宽。

. 否则，选择*跳过此步骤*。




== 第 9 步（共 9 步）：审核摘要

摘要提供有关您配置的项目的详细信息，包括负载均衡器、租户和存储桶的名称、流量分类策略以及活动的 ILM 策略。

.步骤
. 查看摘要。
. 选择*完成*。




== 后续步骤Next steps

完成FabricPool向导后，执行以下附加步骤。

.步骤
. 前往link:configure-ontap.html["配置ONTAP系统管理器"]输入保存的值并完成ONTAP端的连接。您必须将StorageGRID添加为云层，将云层附加到本地层以创建FabricPool，并设置卷分层策略。
. 前往link:configure-dns-server.html["配置 DNS 服务器"]并确保 DNS 包含一条记录，以将StorageGRID服务器名称（完全限定域名）与您将使用的每个StorageGRID IP 地址关联起来。
. 前往link:other-best-practices-for-storagegrid-and-fabricpool.html["StorageGRID和FabricPool的其他最佳实践"]了解StorageGRID审计日志和其他全局配置选项的最佳实践。

