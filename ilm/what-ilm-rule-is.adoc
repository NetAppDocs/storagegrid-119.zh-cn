---
permalink: ilm/what-ilm-rule-is.html 
sidebar: sidebar 
keywords: what is information lifecycle rule, ilm rule 
summary: 为了管理对象，您可以创建一组信息生命周期管理（ILM）规则并将它们组织成 ILM 策略。 
---
= 使用 ILM 规则管理对象
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
为了管理对象，您可以创建一组信息生命周期管理 (ILM) 规则并将它们组织成 ILM 策略。

系统所接收的每个对象都会根据活动策略进行评估。当策略中的规则与对象的元数据匹配时，规则中的指令将决定StorageGRID采取什么操作来复制和存储该对象。


NOTE: 对象元数据不受 ILM 规则管理。相反，对象元数据存储在 Cassandra 数据库中，即所谓的元数据存储。每个站点都会自动维护三个对象元数据副本，以防止数据丢失。



== ILM 规则的要素

ILM 规则包含三个要素：

* *过滤标准*：规则的基本和高级过滤器定义该规则适用于哪些对象。如果对象与所有过滤器匹配， StorageGRID将应用该规则并创建规则的放置说明中指定的对象副本。
* *放置说明*：规则的放置说明定义对象副本的数量、类型和位置。每条规则可以包含一系列放置指令，以便随着时间的推移改变对象副本的数量、类型和位置。当一个安置的时间段到期时，下一个安置中的指令将在下一次 ILM 评估中自动应用。
* *摄取行为*：规则的摄取行为允许您选择在摄取规则过滤的对象时如何保护它们（当 S3 客户端将对象保存到网格时）。




== ILM 规则过滤

创建 ILM 规则时，您可以指定过滤器来确定该规则适用于哪些对象。

在最简单的情况下，规则可能不使用任何过滤器。任何不使用过滤器的规则都适用于所有对象，因此它必须是 ILM 策略中的最后一条（默认）规则。默认规则为与另一个规则中的过滤器不匹配的对象提供存储说明。

* 基本过滤器允许您将不同的规则应用于大量不同的对象组。这些过滤器允许您将规则应用于特定租户帐户、特定 S3 存储桶或两者。
+
基本过滤器为您提供了一种将不同的规则应用于大量对象的简单方法。例如，可能需要存储公司的财务记录以满足监管要求，而可能需要存储营销部门的数据以促进日常运营。为每个部门创建单独的租户帐户或将不同部门的数据分离到单独的 S3 存储桶后，您可以轻松创建一条适用于所有财务记录的规则和一条适用于所有营销数据的规则。

* 高级过滤器可让您进行精细控制。您可以创建过滤器来根据以下对象属性选择对象：
+
** 摄取时间
** 上次访问时间
** 全部或部分对象名称（Key）
** 位置约束（仅限 S3）
** 对象大小
** 用户元数据
** 对象标签（仅限 S3）




您可以根据非常具体的标准过滤对象。例如，医院影像部门存储的对象在 30 天内可能会频繁使用，之后则很少使用，而包含患者就诊信息的对象可能需要复制到医疗网络总部的计费部门。您可以创建过滤器，根据对象名称、大小、S3 对象标签或任何其他相关标准来识别每种类型的对象，然后创建单独的规则来适当地存储每组对象。

您可以根据需要在单个规则中组合过滤器。例如，营销部门可能希望以不同于供应商记录的方式存储大型图像文件，而人力资源部门可能需要集中存储特定地理位置的人事记录和政策信息。在这种情况下，您可以创建按租户帐户过滤的规则来分离每个部门的记录，同时使用每个规则中的过滤器来识别该规则适用的特定类型的对象。



== ILM 规则放置说明

放置指令决定对象数据的存储位置、时间和方式。一个 ILM 规则可以包含一个或多个放置指令。每个安置指令适用于一个时间段。

创建放置说明时：

* 首先指定参考时间，该时间决定了放置指令何时开始。参考时间可能是对象被摄取的时间、对象被访问的时间、版本化对象变为非当前时间或用户定义的时间。
* 接下来，您要指定相对于参考时间的放置应用时间。例如，放置可能从第 0 天开始并持续 365 天，相对于对象被摄取的时间而言。
* 最后，指定副本的类型（复制或擦除编码）以及副本的存储位置。例如，您可能希望在两个不同的站点存储两个副本。


每个规则可以为单个时间段定义多个展示位置，也可以为不同的时间段定义不同的展示位置。

* 要在单个时间段内将对象放置在多个位置，请选择*添加其他类型或位置*以为该时间段添加多条线路。
* 要将物体放置在不同时间段的不同位置，请选择*添加另一个时间段*以添加下一个时间段。然后，指定该时间段内的一行或多行。


该示例显示了创建 ILM 规则向导的定义放置页面上的两个放置说明。

image::../media/ilm_rule_multiple_placements_in_single_time_period.png[网格管理器中的 ILM 放置屏幕]

第一个安置指令image:../media/icon_number_1.png["图标编号 1"]第一年有两行：

* 第一行在两个数据中心站点创建两个复制的对象副本。
* 第二行使用所有数据中心站点创建 6+3 擦除编码副本。


第二次安置指导image:../media/icon_number_2.png["图标编号 1"]一年后创建两个副本并永久保存这些副本。

当您为规则定义放置指令集时，必须确保至少有一条放置指令从第 0 天开始，您定义的时间段之间没有间隙，并且最终放置指令永远持续或直到您不再需要任何对象副本。

当规则中的每个时间段到期时，将应用下一个时间段的内容放置指令。创建新的对象副本并删除任何不需要的副本。



== ILM 规则摄取行为

摄取行为控制是否根据规则中的说明立即放置对象副本，或者是否制作临时副本并稍后应用放置说明。以下摄取行为适用于 ILM 规则：

* *平衡*： StorageGRID尝试在摄取时制作 ILM 规则中指定的所有副本；如果不可能，则制作临时副本并将成功返回给客户端。在可能的情况下，将进行 ILM 规则中指定的复制。
* *严格*：在向客户端返回成功之前，必须完成 ILM 规则中指定的所有复制。
* *双重提交*： StorageGRID立即制作对象的临时副本并将成功返回给客户端。在可能的情况下，将制作 ILM 规则中指定的副本。


.相关信息
* link:data-protection-options-for-ingest.html["收录选项"]
* link:advantages-disadvantages-of-ingest-options.html["摄取选项的优点、缺点和局限性"]
* link:../s3/consistency-controls.html#how-consistency-controls-and-ILM-rules-interact["一致性和 ILM 规则如何相互作用以影响数据保护"]




== ILM 规则示例

例如，ILM 规则可以指定以下内容：

* 仅适用于属于租户 A 的对象。
* 制作这些对象的两个副本，并将每个副本存储在不同的站点。
* “永久”保留这两个副本，这意味着StorageGRID不会自动删除它们。相反， StorageGRID将保留这些对象，直到它们被客户端删除请求或存储桶生命周期到期删除。
* 使用平衡选项进行摄取行为：一旦租户 A 将对象保存到StorageGRID，就会应用双站点放置指令，除非无法立即制作两个所需的副本。
+
例如，如果租户 A 保存对象时站点 2 无法访问，则StorageGRID将在站点 1 的存储节点上制作两个临时副本。一旦站点 2 可用， StorageGRID将在该站点制作所需的副本。



.相关信息
* link:what-storage-pool-is.html["什么是存储池"]
* link:what-cloud-storage-pool-is.html["什么是云存储池"]

