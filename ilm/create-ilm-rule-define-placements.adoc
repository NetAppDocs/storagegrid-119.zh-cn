---
permalink: ilm/create-ilm-rule-define-placements.html 
sidebar: sidebar 
keywords: ilm rule step 2, define placements 
summary: 创建 ILM 规则向导的定义放置步骤允许您定义放置指令，以确定对象的存储时间、副本类型（复制或擦除编码）、存储位置和副本数量。 
---
= 第 2 步（共 3 步）：定义展示位置
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
创建 ILM 规则向导的“定义放置”步骤允许您定义放置指令，以确定对象的存储时间、副本类型（复制或擦除编码）、存储位置和副本数量。


NOTE: 所显示的屏幕截图只是示例。您的结果可能会因您的StorageGRID版本而异。

.关于此任务
一个 ILM 规则可以包含一个或多个放置指令。每个安置指令适用于一个时间段。当您使用多条指令时，时间段必须连续，并且至少一条指令必须从第 0 天开始。指令可以一直持续下去，或者直到您不再需要任何对象副本。

如果您想创建不同类型的副本或在该时间段内使用不同的位置，则每个放置指令可以有多行。

在此示例中，第一年，ILM 规则在站点 1 中存储一个复制副本，在站点 2 中存储一个复制副本。一年后，将制作一份 2+1 擦除编码副本并仅保存在一个站点。

image::../media/ilm_create_ilm_rule_wizard_2.png[创建 ILM 规则向导步骤 2]

.步骤
. 对于*参考时间*，选择计算安置指令的开始时间时使用的时间类型。
+
[cols="1a,2a"]
|===
| 选项 | 描述 


 a| 
摄取时间
 a| 
物体被吞食的时间。



 a| 
上次访问时间
 a| 
上次检索（读取或查看）对象的时间。

要使用此选项，必须为 S3 存储桶启用上次访问时间更新。请参阅link:using-last-access-time-in-ilm-rules.html["在 ILM 规则中使用上次访问时间"] 。



 a| 
用户定义创建时间
 a| 
用户定义元数据中指定的时间。



 a| 
非当前时间
 a| 
如果您在“仅将此规则应用于较旧的对象版本（在启用了版本控制的 S3 存储桶中）？”问题中选择了“是”，则会自动选择“非当前时间”。link:create-ilm-rule-enter-details.html["创建 ILM 规则向导的第 1 步"] 。

|===
+
如果您想创建一个_合规_规则，您必须选择*摄取时间*。请参阅link:managing-objects-with-s3-object-lock.html["使用 S3 对象锁管理对象"] 。

. 在“*时间段和展示位置*”部分中，输入第一个时间段的开始时间和持续时间。
+
例如，您可能想要指定第一年存储对象的位置（从第 0 天开始存储 365 天）。至少有一条指令必须从第 0 天开始。

. 如果您想要创建复制副本：
+
.. 从*按以下方式存储对象*下拉列表中，选择*复制*。
.. 选择您要复印的份数。
+
如果将副本数量更改为 1，则会出现警告。任何时间段内仅创建一个复制副本的 ILM 规则会使数据面临永久丢失的风险。请参阅link:why-you-should-not-use-single-copy-replication.html["为什么不应该使用单副本复制"] 。

+
为了避免风险，请执行以下一项或多项操作：

+
*** 增加该时间段内的副本数量。
*** 将副本添加到其他存储池或云存储池。
*** 选择*擦除编码*而不是*复制*。
+
如果此规则已经为所有时间段创建了多个副本，您可以放心地忽略此警告。



.. 在*副本位于*字段中，选择要添加的存储池。
+
*如果您只指定一个存储池*，请注意StorageGRID只能在任何给定的存储节点上存储一个对象的一个​​复制副本。如果您的网格包含三个存储节点，并且您选择 4 作为副本数，则只会制作三个副本 - 每个存储节点一个副本。

+
触发“无法实现 ILM 放置”警报，表明无法完全应用 ILM 规则。

+
*如果指定多个存储池*，请记住以下规则：

+
*** 副本数不能大于存储池数。
*** 如果副本数等于存储池数，则每个存储池中都会存储该对象的一个副本。
*** 如果副本数量少于存储池数量，则在摄取站点存储一份副本，然后系统分发剩余的副本以保持池之间的磁盘使用平衡，同时确保没有站点获得对象的多份副本。
*** 如果存储池重叠（包含相同的存储节点），则对象的所有副本可能仅保存在一个站点上。因此，不要指定所有存储节点存储池（StorageGRID 11.6 及更早版本）和另一个存储池。




. 如果您想创建擦除编码副本：
+
.. 从*按以下方式存储对象*下拉列表中，选择*擦除编码*。
+

NOTE: 擦除编码最适合大于 1 MB 的对象。不要对小于 200 KB 的对象使用擦除编码，以避免管理非常小的擦除编码片段的开销。

.. 如果您没有添加大于 200 KB 的对象大小过滤器，请选择 *上一步* 返回步骤 1。然后，选择*添加高级过滤器*并将*对象大小*过滤器设置为大于 200 KB 的任何值。
.. 选择要添加的存储池和要使用的擦除编码方案。
+
擦除编码副本的存储位置包括擦除编码方案的名称，后跟存储池的名称。

+
可用的擦除编码方案受您选择的存储池中的存储节点数量的限制。一个 `Recommended`徽章出现在提供以下任一方案的旁边link:../ilm/what-erasure-coding-schemes-are.html["最佳保护或最低存储开销"]。



. 可选：
+
.. 选择*添加其他类型或位置*以在不同位置创建其他副本。
.. 选择*添加另一个时间段*来添加不同的时间段。
+
[NOTE]
====
对象删除基于以下设置：

*** 除非另一个时间段以*永远*结束，否则对象会在最后一个时间段结束时自动删除。
*** 根据link:../ilm/example-8-priorities-for-s3-bucket-lifecycle-and-ilm-policy.html#example-of-bucket-lifecycle-taking-priority-over-ilm-policy["存储桶和租户保留期设置"]，即使 ILM 保留期结束，对象也可能不会被删除。


====


. 如果要将对象存储在云存储池中：
+
.. 在“*按以下方式存储对象*”下拉列表中，选择“*复制*”。
.. 选择“*副本于*”字段，然后选择一个云存储池。
+
使用云存储池时，请记住以下规则：

+
*** 您无法在单个放置说明中选择多个云存储池。同样，您不能在同一个放置指令中选择云存储池和存储池。
*** 您只能在任何给定的云存储池中存储一个对象的一个副本。如果将 *Copies* 设置为 2 或更多，则会出现错误消息。
*** 您不能同时在任何云存储池中存储多个对象副本。如果使用云存储池的多个展示位置的日期重叠，或者同一展示位置中的多条线路使用云存储池，则会出现错误消息。
*** 您可以将对象存储在云存储池中，同时将该对象作为复制或擦除编码副本存储在StorageGRID中。但是，您必须在时间段的放置说明中包含多行，以便可以指定每个位置的副本数量和类型。




. 在保留图中，确认您的放置说明。
+
在此示例中，第一年，ILM 规则在站点 1 中存储一个复制副本，在站点 2 中存储一个复制副本。一年后以及接下来的十年内，将在三个站点保存 6+3 擦除编码副本。总共 11 年后，这些对象将从StorageGRID中删除。

+
保留图的规则分析部分指出：

+
** StorageGRID站点丢失保护将在此规则有效期内适用。
** 按照此规则处理的对象将在第 4015 天后被删除。
+
请参阅link:using-multiple-storage-pools-for-cross-site-replication.html["启用站点丢失保护。"]

+
image::../media/ilm_rule_retention_diagram.png[ILM 规则保留图]



. 选择*继续*。link:create-ilm-rule-select-ingest-behavior.html["步骤 3（选择摄取行为）"]出现创建 ILM 规则向导。

